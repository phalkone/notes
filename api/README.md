# API

## Users

### Schema

Field | Type | Comment
----- | ---- | -------
_id   | ObjectID | Autogenerated MongoDB
email | String | Unique string in valid email format (verified against regex)
password | String | String (min 8 characters with a mix of lower-, uppercase and symbols)
roles | [String] | Array of strings according to predefined roles
notes | [ObjectId] | Array of notes belonging to user
tags | [String] | Array of unique strings defining all tags used in the notes

### Overview

URL | Method | Action
--- | ------ | ------
/users | POST | Create a new user
/users/:id | GET | Returns all information regarding present user's profile
/users | GET | Returns all users - for admin only
/users/:id | PUT | Update user information
/users/:id | DELETE | Delete user

### Create new user

    POST /users

Name | Type | In | Description
----- | --- | -- | -----------
email | String | body | unique email of the user in valid format
password | String | body | password of user

### List all users

    GET /users

Name | Type | In | Description
----- | --- | -- | -----------
x-access-token | String | header | authentication (must be admin)
email | String | query | *optional* filter by email
roles | String | query | *optional* filter by role
page | int | query | *optional*  page number - default 0
max_page | int | query | *optional* results per page - default 20

### Get individual user

    GET /users/:id

Name | Type | In | Description
----- | --- | -- | -----------
x-access-token | String | header | authentication
id | String | path | present user id

### Update individual user

    PUT /users/:id

Name | Type | In | Description
----- | --- | -- | -----------
x-access-token | String | header | authentication
id | String | path | present user id

### Delete individual user

    PUT /users/:id

Name | Type | In | Description
----- | --- | -- | -----------
x-access-token | String | header | authentication
id | String | path | present user id

## Sessions

### General

Authentication is based on JSON web tokens. Pass a JWT in each HTTP header x-access-token to make authenticated request.

### Overview

URL | Method | Action
--- | ------ | ------
/sessions | POST | To log in a user
/sessions/:id | DELETE | To log out a user

### Open new session

    POST /sessions

Name | Type | In | Description
----- | --- | -- | -----------
x-access-token | String | header | authentication
email | String | body | email of user
password | String | body | password of user

Returns JWT valid for 7 days or until session is closed.

### Close session

    DElETE /sessions/:jwt

Name | Type | In | Description
----- | --- | -- | -----------
x-access-token | String | header | authentication
id | String | path | ID of the session

## Notes

### Schema

Field | Type | Comment
----- | ---- | -------
title | String | Mandatory
body | String | Mandatory
favorite | Boolean | Default false
tags | [String] | Optional
created_on | Date | Automatic date value
updated_on | Date | Autonatic date value

### Overview

URL | Method | Action
--- | ------ | ------
/notes | POST | Create new note
/notes | GET | Return all notes of user (optional search criteria)
/notes/:id | GET | Get note by ID
/notes/:id | PUT | Update note
/notes/:id | DELETE | Delete note

### Create new note

    POST /notes

Name | Type | In | Description
----- | --- | -- | -----------
x-access-token | String | header | authentication
title | String | body | *optional* title of note
body | String | body | *optional* body of note
favorite | Boolean | body | *optional* mark as favorite
tags | [String] | body | *optional* mark as favorite
files | [ObjectId] | body | *optional* files contained in the note

### List notes

    GET /notes

Name | Type | In | Description
----- | --- | -- | -----------
x-access-token | String | header | authentication
title | String | query | *optional* title of note
favorite | Boolean | query | *optional* mark as favorite
tags | [String] | query | *optional* mark as favorite
page | int | query | *optional*  page number - default 0
max_page | int | query | *optional* results per page - default 20

### Get specific note

    GET /notes/:id

Name | Type | In | Description
----- | --- | -- | -----------
x-access-token | String | header | authentication
id | String | path | id of note

### Update specific note

    PUT /notes/:id

Name | Type | In | Description
----- | --- | -- | -----------
x-access-token | String | header | authentication
id | String | path | id of note

### Delete specific note

    DELETE /notes/:id

Name | Type | In | Description
----- | --- | -- | -----------
x-access-token | String | header | authentication
id | String | path | id of note

## Files

### Schema

Field | Type | Comment
----- | ---- | -------
filename | String | Mandatory

### Overview

URL | Method | Action
--- | ------ | ------
/files/;id | POST | Create new file for a given note id
/files/:id | GET | Get file by ID
/files/:id | DELETE | Delete file
